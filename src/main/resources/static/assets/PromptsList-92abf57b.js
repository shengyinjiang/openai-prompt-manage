import{_ as e}from"./ContentWrap.vue_vue_type_script_setup_true_lang-7d720f0a.js";import{u as a,a as o,_ as t}from"./useCrudSchemas-e1606b93.js";import{d as s,q as l,s as r,o as n,c as i,e as c,v as d,n as u,a as m,t as p,g as f,w as g,h as v,x as h,E as b,y,z as _,_ as x,C as w,A as C,B as k,r as R,D as j,F as S,G as $,H as D,I as A,i as F,J as P,K as z,L,M as H,N as E,O as I,P as M,Q as T,R as q,S as O,U,u as V,V as B,k as G}from"./index-a4efef0e.js";import{u as K,E as N,a as W}from"./tree-cc87d18e.js";import{d as J,a as Q,b as X,c as Y,u as Z}from"./use-dialog-6a7b234c.js";import{u as ee}from"./el-input-763158f1.js";import{F as ae,E as oe}from"./el-popper-5af16893.js";import{c as te}from"./refs-d274a856.js";import{u as se,E as le}from"./el-button-5e3ca3eb.js";import{_ as re}from"./Table.vue_vue_type_script_lang-bc702329.js";import{q as ne,d as ie,a as ce}from"./index-0bb17513.js";import{_ as de}from"./Write.vue_vue_type_script_setup_true_lang-76027e8d.js";import"./useForm-e296b64d.js";import"./el-tag-79e961c8.js";import"./tsxHelper-d30ca50a.js";import"./el-divider-61b08157.js";import"./_plugin-vue_export-helper-1b428a4d.js";import"./index-b9ec11c4.js";import"./vnode-44ae06e4.js";import"./useValidator-d3f5ebd5.js";const ue=Symbol("dialogInjectionKey"),me=["aria-label"],pe=["id"],fe=s({name:"ElDialogContent"});var ge=x(s({...fe,props:J,emits:Q,setup(e){const a=e,{t:o}=ee(),{Close:t}=w,{dialogRef:s,headerRef:x,bodyId:C,ns:k,style:R}=l(ue),{focusTrapRef:j}=l(ae),S=te(j,s),$=r((()=>a.draggable));return K(s,x,$),(e,a)=>(n(),i("div",{ref:m(S),class:u([m(k).b(),m(k).is("fullscreen",e.fullscreen),m(k).is("draggable",m($)),m(k).is("align-center",e.alignCenter),{[m(k).m("center")]:e.center},e.customClass]),style:_(m(R)),tabindex:"-1"},[c("header",{ref_key:"headerRef",ref:x,class:u(m(k).e("header"))},[d(e.$slots,"header",{},(()=>[c("span",{role:"heading",class:u(m(k).e("title"))},p(e.title),3)])),e.showClose?(n(),i("button",{key:0,"aria-label":m(o)("el.dialog.close"),class:u(m(k).e("headerbtn")),type:"button",onClick:a[0]||(a[0]=a=>e.$emit("close"))},[f(m(b),{class:u(m(k).e("close"))},{default:g((()=>[(n(),v(h(e.closeIcon||m(t))))])),_:1},8,["class"])],10,me)):y("v-if",!0)],2),c("div",{id:m(C),class:u(m(k).e("body"))},[d(e.$slots,"default")],10,pe),e.$slots.footer?(n(),i("footer",{key:0,class:u(m(k).e("footer"))},[d(e.$slots,"footer")],2)):y("v-if",!0)],6))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/dialog/src/dialog-content.vue"]]);const ve=["aria-label","aria-labelledby","aria-describedby"],he=s({name:"ElDialog",inheritAttrs:!1});const be=z(x(s({...he,props:X,emits:Y,setup(e,{expose:a}){const o=e,t=C();se({scope:"el-dialog",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/dialog.html#slots"},r((()=>!!t.title))),se({scope:"el-dialog",from:"custom-class",replacement:"class",version:"2.3.0",ref:"https://element-plus.org/en-US/component/dialog.html#attributes",type:"Attribute"},r((()=>!!o.customClass)));const s=k("dialog"),l=R(),i=R(),p=R(),{visible:h,titleId:b,bodyId:x,style:w,overlayDialogStyle:z,rendered:L,zIndex:H,afterEnter:E,afterLeave:I,beforeLeave:M,handleClose:T,onModalClick:q,onOpenAutoFocus:O,onCloseAutoFocus:U,onCloseRequested:V,onFocusoutPrevented:B}=Z(o,l);j(ue,{dialogRef:l,headerRef:i,bodyId:x,ns:s,rendered:L,style:w});const G=W(q),K=r((()=>o.draggable&&!o.fullscreen));return a({visible:h,dialogContentRef:p}),(e,a)=>(n(),v(P,{to:"body",disabled:!e.appendToBody},[f(F,{name:"dialog-fade",onAfterEnter:m(E),onAfterLeave:m(I),onBeforeLeave:m(M),persisted:""},{default:g((()=>[S(f(m(N),{"custom-mask-event":"",mask:e.modal,"overlay-class":e.modalClass,"z-index":m(H)},{default:g((()=>[c("div",{role:"dialog","aria-modal":"true","aria-label":e.title||void 0,"aria-labelledby":e.title?void 0:m(b),"aria-describedby":m(x),class:u(`${m(s).namespace.value}-overlay-dialog`),style:_(m(z)),onClick:a[0]||(a[0]=(...e)=>m(G).onClick&&m(G).onClick(...e)),onMousedown:a[1]||(a[1]=(...e)=>m(G).onMousedown&&m(G).onMousedown(...e)),onMouseup:a[2]||(a[2]=(...e)=>m(G).onMouseup&&m(G).onMouseup(...e))},[f(m(oe),{loop:"",trapped:m(h),"focus-start-el":"container",onFocusAfterTrapped:m(O),onFocusAfterReleased:m(U),onFocusoutPrevented:m(B),onReleaseRequested:m(V)},{default:g((()=>[m(L)?(n(),v(ge,$({key:0,ref_key:"dialogContentRef",ref:p},e.$attrs,{"custom-class":e.customClass,center:e.center,"align-center":e.alignCenter,"close-icon":e.closeIcon,draggable:m(K),fullscreen:e.fullscreen,"show-close":e.showClose,title:e.title,onClose:m(T)}),D({header:g((()=>[e.$slots.title?d(e.$slots,"title",{key:1}):d(e.$slots,"header",{key:0,close:m(T),titleId:m(b),titleClass:m(s).e("title")})])),default:g((()=>[d(e.$slots,"default")])),_:2},[e.$slots.footer?{name:"footer",fn:g((()=>[d(e.$slots,"footer")]))}:void 0]),1040,["custom-class","center","align-center","close-icon","draggable","fullscreen","show-close","title","onClose"])):y("v-if",!0)])),_:3},8,["trapped","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])],46,ve)])),_:3},8,["mask","overlay-class","z-index"]),[[A,m(h)]])])),_:3},8,["onAfterEnter","onAfterLeave","onBeforeLeave"])],8,["disabled"]))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/dialog/src/dialog.vue"]])),ye={class:"flex justify-between"},_e=s({__name:"Dialog",props:{modelValue:L.bool.def(!1),title:L.string.def("Dialog"),fullscreen:L.bool.def(!0),maxHeight:L.oneOfType([String,Number]).def("500px")},setup(e){const a=e,o=C(),t=r((()=>{const e=["fullscreen","title","maxHeight"],o={...M(),...a};for(const a in o)-1!==e.indexOf(a)&&delete o[a];return o})),s=R(!1),l=()=>{s.value=!m(s)},i=R(H(a.maxHeight)?`${a.maxHeight}px`:a.maxHeight);E((()=>s.value),(async e=>{if(await q(),e){const e=document.documentElement.offsetHeight;i.value=e-55-60-(o.footer?63:0)+"px"}else i.value=H(a.maxHeight)?`${a.maxHeight}px`:a.maxHeight}),{immediate:!0});const u=r((()=>({height:m(i)})));return(a,r)=>{const i=I("Icon");return n(),v(m(be),$(m(t),{fullscreen:s.value,"destroy-on-close":"","lock-scroll":"",draggable:"","close-on-click-modal":!1}),D({header:g((()=>[c("div",ye,[d(a.$slots,"title",{},(()=>[O(p(e.title),1)])),e.fullscreen?(n(),v(i,{key:0,class:"mr-18px cursor-pointer is-hover mt-2px z-10",icon:s.value?"zmdi:fullscreen-exit":"zmdi:fullscreen",color:"var(--el-color-info)",onClick:l},null,8,["icon"])):y("",!0)])])),default:g((()=>[f(m(T),{style:_(m(u))},{default:g((()=>[d(a.$slots,"default")])),_:3},8,["style"])])),_:2},[m(o).footer?{name:"footer",fn:g((()=>[d(a.$slots,"footer")])),key:"0"}:void 0]),1040,["fullscreen"])}}});const xe={all:we=we||new Map,on:function(e,a){var o=we.get(e);o?o.push(a):we.set(e,[a])},off:function(e,a){var o=we.get(e);o&&(a?o.splice(o.indexOf(a)>>>0,1):we.set(e,[]))},emit:function(e,a){var o=we.get(e);o&&o.slice().map((function(e){e(a)})),(o=we.get("*"))&&o.slice().map((function(o){o(e,a)}))}};var we;const Ce={class:"mb-10px"},ke=s({name:"PromptsList"}),Re=s({...ke,setup(s){const l=R(!1),{push:r}=V(),{register:i,tableObject:d,methods:u}=a({getListApi:ne,delListApi:ie,response:{list:"records",total:"total"}}),{getList:h,setSearchParams:b}=u;var y;h(),(y={name:"getList",callback:e=>{"add"===e&&(d.currentPage=1),h()}})&&(xe.on(y.name,y.callback),U((()=>{xe.off(y.name)})));const{t:_}=G(),x=B([{field:"index",label:_("tableDemo.index"),type:"index",form:{show:!1}},{field:"prompt",label:"提问",search:{show:!0},table:{show:!0},form:{component:"Editor",colProps:{span:36},componentProps:{height:260}},detail:{span:24}},{field:"promptResult",label:"回答",form:{show:!1}},{field:"createTime",label:_("tableDemo.displayTime"),form:{show:!1}},{field:"promptStatus",label:"状态",form:{show:!1}},{field:"content",label:_("exampleDemo.content"),table:{show:!1},form:{show:!1}},{field:"action",width:"260px",label:_("tableDemo.action"),form:{show:!1}}]),{allSchemas:w}=o(x),C=()=>{l.value=!l.value},k=R(!1),j=R(),S=R(!1),$=async()=>{var e;const a=m(j);await(null==(e=null==a?void 0:a.elFormRef)?void 0:e.validate((async e=>{if(e){S.value=!0;const e=await(null==a?void 0:a.getFormData());await ce({prompts:(o=e.prompt,o.replace(/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,""))}).catch((()=>{})).finally((()=>{S.value=!1})),l.value=!1,d.currentPage=1,h()}var o})))};return(a,o)=>{const s=I("Detail");return n(),v(m(e),null,{default:g((()=>[f(m(_e),{title:"新增",modelValue:l.value,"onUpdate:modelValue":o[1]||(o[1]=e=>l.value=e),maxHeight:410},{footer:g((()=>[f(m(le),{type:"primary",onClick:$,loading:S.value},{default:g((()=>[O(p(m(_)("exampleDemo.save")),1)])),_:1},8,["loading"]),f(m(le),{onClick:o[0]||(o[0]=e=>l.value=!1)},{default:g((()=>[O(p(m(_)("dialogDemo.close")),1)])),_:1})])),default:g((()=>[f(s,{"detail-schema":m(w).detailSchema,"current-row":m(d).currentRow},null,8,["detail-schema","current-row"]),f(de,{ref_key:"writeRef",ref:j,"form-schema":m(w).formSchema,"current-row":m(d).currentRow},null,8,["form-schema","current-row"])])),_:1},8,["modelValue"]),f(m(t),{schema:m(w).searchSchema,onSearch:m(b),onReset:m(b)},null,8,["schema","onSearch","onReset"]),c("div",Ce,[f(m(le),{type:"primary",onClick:C},{default:g((()=>[O(p(m(_)("exampleDemo.add")),1)])),_:1})]),f(m(re),{pageSize:m(d).pageSize,"onUpdate:pageSize":o[2]||(o[2]=e=>m(d).pageSize=e),currentPage:m(d).currentPage,"onUpdate:currentPage":o[3]||(o[3]=e=>m(d).currentPage=e),columns:m(w).tableColumns,data:m(d).tableList,loading:m(d).loading,pagination:{total:m(d).total},onRegister:m(i)},{action:g((({row:e})=>[f(m(le),{type:"success",onClick:a=>((e,a)=>{r(`/chatgpt/prompts-${a}?id=${e.id}`)})(e,"detail")},{default:g((()=>[O(p(m(_)("exampleDemo.detail")),1)])),_:2},1032,["onClick"]),f(m(le),{type:"danger",onClick:a=>(async(e,a)=>{var o;d.currentRow=e;const{delList:t,getSelections:s}=u,l=await s();k.value=!0,await t(a?l.map((e=>e.id)):[null==(o=d.currentRow)?void 0:o.id],a).finally((()=>{k.value=!1})),h()})(e,!1)},{default:g((()=>[O(p(m(_)("exampleDemo.del")),1)])),_:2},1032,["onClick"])])),_:1},8,["pageSize","currentPage","columns","data","loading","pagination","onRegister"])])),_:1})}}});export{Re as default};
