import{u as e,F as s}from"./useForm-a96365b0.js";import{$ as a,a0 as o,d as t,B as l,s as i,o as r,c as n,h as d,w as c,x as u,a as p,E as m,y as f,n as g,v as h,_ as v,K as w,b as y,m as b,u as k,a1 as j,V as x,r as R,N as _,O as P,e as I,t as z,g as E,S as F,k as A}from"./index-fd4ebc93.js";import{E as C}from"./el-button-e210cb9e.js";import{E as V}from"./tsxHelper-102b0284.js";import{l as $,a as q,b as D}from"./index-e7bbfcea.js";import{u as B}from"./useValidator-f0e60fbf.js";import{_ as L}from"./_plugin-vue_export-helper-1b428a4d.js";import"./el-popper-510a25b6.js";import"./index-6469e796.js";import"./el-input-8087ab66.js";import"./el-tag-f909f789.js";import"./el-divider-ee4cebcf.js";import"./index-ed161512.js";import"./axios-44a859f9.js";const S=a({type:{type:String,values:["primary","success","warning","info","danger","default"],default:"default"},underline:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},href:{type:String,default:""},icon:{type:o}}),N={click:e=>e instanceof MouseEvent},U=["href"],H=t({name:"ElLink"});const K=w(v(t({...H,props:S,emits:N,setup(e,{emit:s}){const a=e,o=l("link"),t=i((()=>[o.b(),o.m(a.type),o.is("disabled",a.disabled),o.is("underline",a.underline&&!a.disabled)]));function v(e){a.disabled||s("click",e)}return(e,s)=>(r(),n("a",{class:g(p(t)),href:e.disabled||!e.href?void 0:e.href,onClick:v},[e.icon?(r(),d(p(m),{key:0},{default:c((()=>[(r(),d(u(e.icon)))])),_:1})):f("v-if",!0),e.$slots.default?(r(),n("span",{key:1,class:g(p(o).e("inner"))},[h(e.$slots,"default")],2)):f("v-if",!0),e.$slots.icon?h(e.$slots,"icon",{key:2}):f("v-if",!0)],10,U))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/link/src/link.vue"]])),M={class:"text-2xl font-bold text-center w-[100%]"},O={class:"flex justify-between items-center w-[100%]"},G={class:"w-[100%]"},J={class:"w-[100%] mt-15px"},Q={class:"flex justify-between w-[100%]"},T=L(t({__name:"LoginForm",emits:["to-register"],setup(a,{emit:o}){const{required:t}=B(),l=y(),i=b(),{currentRoute:n,addRoute:u,push:m}=k(),{wsCache:f}=j(),{t:g}=A(),h={username:[t()],password:[t()]},v=x([{field:"title",colProps:{span:24}},{field:"username",label:g("login.username"),value:"admin",component:"Input",colProps:{span:24},componentProps:{placeholder:g("login.usernamePlaceholder")}},{field:"password",label:g("login.password"),value:"admin",component:"InputPassword",colProps:{span:24},componentProps:{style:{width:"100%"},placeholder:g("login.passwordPlaceholder")}},{field:"tool",colProps:{span:24}},{field:"login",colProps:{span:24}},{field:"other",component:"Divider",label:g("login.otherLogin"),componentProps:{contentPosition:"center"}},{field:"otherIcon",colProps:{span:24}}]),w=R(!1),{register:L,elFormRef:S,methods:N}=e(),U=R(!1),H="#999",T=R("");_((()=>n.value),(e=>{var s;T.value=null==(s=null==e?void 0:e.query)?void 0:s.redirect}),{immediate:!0});const W=async()=>{const e=p(S);await(null==e?void 0:e.validate((async e=>{if(e){U.value=!0;const{getFormData:e}=N,s=await e();try{const e=await $(s);e&&(f.set(l.getUserInfo,e.data),l.getDynamicRouter?X():(await i.generateRoutes("none").catch((()=>{})),i.getAddRouters.forEach((e=>{u(e)})),i.setIsAddRouters(!0),m({path:T.value||i.addRouters[0].path})))}finally{U.value=!1}}})))},X=async()=>{const{getFormData:e}=N,s=await e(),a={roleName:s.username},o="admin"===s.username?await q(a):await D(a);if(o){const{wsCache:e}=j(),a=o.data||[];e.set("roleRouters",a),"admin"===s.username?await i.generateRoutes("admin",a).catch((()=>{})):await i.generateRoutes("test",a).catch((()=>{})),i.getAddRouters.forEach((e=>{u(e)})),i.setIsAddRouters(!0),m({path:T.value||i.addRouters[0].path})}},Y=()=>{o("to-register")};return(e,a)=>{const o=P("Icon");return r(),d(p(s),{schema:v,rules:h,"label-position":"top","hide-required-asterisk":"",size:"large",class:"dark:border-1 dark:border-[var(--el-border-color)] dark:border-solid",onRegister:p(L)},{title:c((()=>[I("h2",M,z(p(g)("login.login")),1)])),tool:c((()=>[I("div",O,[E(p(V),{modelValue:w.value,"onUpdate:modelValue":a[0]||(a[0]=e=>w.value=e),label:p(g)("login.remember"),size:"small"},null,8,["modelValue","label"]),E(p(K),{type:"primary",underline:!1},{default:c((()=>[F(z(p(g)("login.forgetPassword")),1)])),_:1})])])),login:c((()=>[I("div",G,[E(p(C),{loading:U.value,type:"primary",class:"w-[100%]",onClick:W},{default:c((()=>[F(z(p(g)("login.login")),1)])),_:1},8,["loading"])]),I("div",J,[E(p(C),{class:"w-[100%]",onClick:Y},{default:c((()=>[F(z(p(g)("login.register")),1)])),_:1})])])),otherIcon:c((()=>[I("div",Q,[E(o,{icon:"ant-design:github-filled",size:30,class:"cursor-pointer anticon",color:H}),E(o,{icon:"ant-design:wechat-filled",size:30,class:"cursor-pointer anticon",color:H}),E(o,{icon:"ant-design:alipay-circle-filled",size:30,color:H,class:"cursor-pointer anticon"}),E(o,{icon:"ant-design:weibo-circle-filled",size:30,color:H,class:"cursor-pointer anticon"})])])),_:1},8,["schema","onRegister"])}}}),[["__scopeId","data-v-502014e3"]]);export{T as default};
