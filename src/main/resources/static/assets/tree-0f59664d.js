import{bu as e,b8 as n,U as t,ay as o,aw as s,bj as a,B as l,d3 as r,bp as i,by as c,N as u,bA as d,bx as p,d4 as m,bz as f,bK as v,R as g,bU as h,$ as b,b5 as y,d as C,g as E,v as x,Z as w,E as M,d5 as k,r as B,bl as I,V as T,s as S,d6 as L,aA as z,bo as A,_ as R,O as P,o as _,h as O,w as $,F as j,e as V,n as H,z as Y,bN as D,c as K,x as q,y as U,t as X,bc as F,S as N,I as W,i as Z,bG as G,cm as J,d7 as Q,bi as ee,bn as ne,bW as te,bV as oe,cD as se}from"./index-fd4ebc93.js";import{E as ae}from"./el-button-e210cb9e.js";import{g as le,E as re,c as ie,u as ce}from"./el-input-8087ab66.js";import{P as ue}from"./vnode-3f505451.js";import{o as de}from"./el-divider-ee4cebcf.js";import{E as pe}from"./el-popper-510a25b6.js";import{u as me}from"./index-6469e796.js";const fe=(s,a,l)=>{let r={offsetX:0,offsetY:0};const i=e=>{const n=e.clientX,t=e.clientY,{offsetX:a,offsetY:l}=r,i=s.value.getBoundingClientRect(),c=i.left,u=i.top,d=i.width,p=i.height,m=document.documentElement.clientWidth,f=document.documentElement.clientHeight,v=-c+a,g=-u+l,h=m-c-d+a,b=f-u-p+l,y=e=>{const i=Math.min(Math.max(a+e.clientX-n,v),h),c=Math.min(Math.max(l+e.clientY-t,g),b);r={offsetX:i,offsetY:c},s.value.style.transform=`translate(${o(i)}, ${o(c)})`},C=()=>{document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",C)};document.addEventListener("mousemove",y),document.addEventListener("mouseup",C)},c=()=>{a.value&&s.value&&a.value.removeEventListener("mousedown",i)};e((()=>{n((()=>{l.value?a.value&&s.value&&a.value.addEventListener("mousedown",i):c()}))})),t((()=>{c()}))},ve=e=>{s(e)||a("[useLockscreen]","You need to pass a ref param to this function");const n=l("popup"),t=r((()=>n.bm("parent","hidden")));if(!i||c(document.body,t.value))return;let o=0,v=!1,g="0";const h=()=>{setTimeout((()=>{f(null==document?void 0:document.body,t.value),v&&document&&(document.body.style.width=g)}),200)};u(e,(e=>{if(!e)return void h();v=!c(document.body,t.value),v&&(g=document.body.style.width),o=le(n.namespace.value);const s=document.documentElement.clientHeight<document.body.scrollHeight,a=d(document.body,"overflowY");o>0&&(s||"scroll"===a)&&v&&(document.body.style.width=`calc(100% - ${o}px)`),p(document.body,t.value)})),m((()=>h()))},ge=e=>{if(!e)return{onClick:v,onMousedown:v,onMouseup:v};let n=!1,t=!1;return{onClick:o=>{n&&t&&e(o),n=t=!1},onMousedown:e=>{n=e.target===e.currentTarget},onMouseup:e=>{t=e.target===e.currentTarget}}},he="_trap-focus-children",be=[],ye=e=>{if(0===be.length)return;const n=be[be.length-1][he];if(n.length>0&&e.code===h.tab){if(1===n.length)return e.preventDefault(),void(document.activeElement!==n[0]&&n[0].focus());const t=e.shiftKey,o=e.target===n[0],s=e.target===n[n.length-1];o&&t&&(e.preventDefault(),n[n.length-1].focus()),s&&!t&&(e.preventDefault(),n[0].focus())}},Ce={beforeMount(e){e[he]=de(e),be.push(e),be.length<=1&&document.addEventListener("keydown",ye)},updated(e){g((()=>{e[he]=de(e)}))},unmounted(){be.shift(),0===be.length&&document.removeEventListener("keydown",ye)}};const Ee=C({name:"ElOverlay",props:b({mask:{type:Boolean,default:!0},customMaskEvent:{type:Boolean,default:!1},overlayClass:{type:y([String,Array,Object])},zIndex:{type:y([String,Number])}}),emits:{click:e=>e instanceof MouseEvent},setup(e,{slots:n,emit:t}){const o=l("overlay"),{onClick:s,onMousedown:a,onMouseup:r}=ge(e.customMaskEvent?void 0:e=>{t("click",e)});return()=>e.mask?E("div",{class:[o.b(),e.overlayClass],style:{zIndex:e.zIndex},onClick:s,onMousedown:a,onMouseup:r},[x(n,"default")],ue.STYLE|ue.CLASS|ue.PROPS,["onClick","onMouseup","onMousedown"]):w("div",{class:e.overlayClass,style:{zIndex:e.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[x(n,"default")])}}),xe=C({name:"ElMessageBox",directives:{TrapFocus:Ce},components:{ElButton:ae,ElFocusTrap:pe,ElInput:re,ElOverlay:Ee,ElIcon:M,...k},inheritAttrs:!1,props:{buttonSize:{type:String,validator:ie},modal:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},closeOnHashChange:{type:Boolean,default:!0},center:Boolean,draggable:Boolean,roundButton:{default:!1,type:Boolean},container:{type:String,default:"body"},boxType:{type:String,default:""}},emits:["vanish","action"],setup(n,{emit:o}){const{t:a}=ce(),r=l("message-box"),i=B(!1),{nextZIndex:c}=I(),d=T({autofocus:!0,beforeClose:null,callback:null,cancelButtonText:"",cancelButtonClass:"",confirmButtonText:"",confirmButtonClass:"",customClass:"",customStyle:{},dangerouslyUseHTMLString:!1,distinguishCancelAndClose:!1,icon:"",inputPattern:null,inputPlaceholder:"",inputType:"text",inputValue:null,inputValidator:null,inputErrorMessage:"",message:null,modalFade:!0,modalClass:"",showCancelButton:!1,showConfirmButton:!0,type:"",title:void 0,showInput:!1,action:"",confirmButtonLoading:!1,cancelButtonLoading:!1,confirmButtonDisabled:!1,editorErrorMessage:"",validateError:!1,zIndex:c()}),p=S((()=>{const e=d.type;return{[r.bm("icon",e)]:e&&L[e]}})),m=me(),f=me(),v=z(S((()=>n.buttonSize)),{prop:!0,form:!0,formItem:!0}),h=S((()=>d.icon||L[d.type]||"")),b=S((()=>!!d.message)),y=B(),C=B(),E=B(),x=B(),w=B(),M=S((()=>d.confirmButtonClass));u((()=>d.inputValue),(async e=>{await g(),"prompt"===n.boxType&&null!==e&&$()}),{immediate:!0}),u((()=>i.value),(e=>{var t,o;e&&("prompt"!==n.boxType&&(d.autofocus?E.value=null!=(o=null==(t=w.value)?void 0:t.$el)?o:y.value:E.value=y.value),d.zIndex=c()),"prompt"===n.boxType&&(e?g().then((()=>{var e;x.value&&x.value.$el&&(d.autofocus?E.value=null!=(e=j())?e:y.value:E.value=y.value)})):(d.editorErrorMessage="",d.validateError=!1))}));const k=S((()=>n.draggable));function R(){i.value&&(i.value=!1,g((()=>{d.action&&o("action",d.action)})))}fe(y,C,k),e((async()=>{await g(),n.closeOnHashChange&&window.addEventListener("hashchange",R)})),t((()=>{n.closeOnHashChange&&window.removeEventListener("hashchange",R)}));const P=()=>{n.closeOnClickModal&&O(d.distinguishCancelAndClose?"close":"cancel")},_=ge(P),O=e=>{var t;("prompt"!==n.boxType||"confirm"!==e||$())&&(d.action=e,d.beforeClose?null==(t=d.beforeClose)||t.call(d,e,d,R):R())},$=()=>{if("prompt"===n.boxType){const e=d.inputPattern;if(e&&!e.test(d.inputValue||""))return d.editorErrorMessage=d.inputErrorMessage||a("el.messagebox.error"),d.validateError=!0,!1;const n=d.inputValidator;if("function"==typeof n){const e=n(d.inputValue);if(!1===e)return d.editorErrorMessage=d.inputErrorMessage||a("el.messagebox.error"),d.validateError=!0,!1;if("string"==typeof e)return d.editorErrorMessage=e,d.validateError=!0,!1}}return d.editorErrorMessage="",d.validateError=!1,!0},j=()=>{const e=x.value.$refs;return e.input||e.textarea},V=()=>{O("close")};return n.lockScroll&&ve(i),((e,n)=>{let t;u((()=>e.value),(e=>{var o,a;e?(t=document.activeElement,s(n)&&(null==(a=(o=n.value).focus)||a.call(o))):t.focus()}))})(i),{...A(d),ns:r,overlayEvent:_,visible:i,hasMessage:b,typeClass:p,contentId:m,inputId:f,btnSize:v,iconComponent:h,confirmButtonClasses:M,rootRef:y,focusStartRef:E,headerRef:C,inputRef:x,confirmRef:w,doClose:R,handleClose:V,onCloseRequested:()=>{n.closeOnPressEscape&&V()},handleWrapperClick:P,handleInputEnter:e=>{if("textarea"!==d.inputType)return e.preventDefault(),O("confirm")},handleAction:O,t:a}}}),we=["aria-label","aria-describedby"],Me=["aria-label"],ke=["id"];var Be=R(xe,[["render",function(e,n,t,o,s,a){const l=P("el-icon"),r=P("close"),i=P("el-input"),c=P("el-button"),u=P("el-focus-trap"),d=P("el-overlay");return _(),O(Z,{name:"fade-in-linear",onAfterLeave:n[11]||(n[11]=n=>e.$emit("vanish")),persisted:""},{default:$((()=>[j(E(d,{"z-index":e.zIndex,"overlay-class":[e.ns.is("message-box"),e.modalClass],mask:e.modal},{default:$((()=>[V("div",{role:"dialog","aria-label":e.title,"aria-modal":"true","aria-describedby":e.showInput?void 0:e.contentId,class:H(`${e.ns.namespace.value}-overlay-message-box`),onClick:n[8]||(n[8]=(...n)=>e.overlayEvent.onClick&&e.overlayEvent.onClick(...n)),onMousedown:n[9]||(n[9]=(...n)=>e.overlayEvent.onMousedown&&e.overlayEvent.onMousedown(...n)),onMouseup:n[10]||(n[10]=(...n)=>e.overlayEvent.onMouseup&&e.overlayEvent.onMouseup(...n))},[E(u,{loop:"",trapped:e.visible,"focus-trap-el":e.rootRef,"focus-start-el":e.focusStartRef,onReleaseRequested:e.onCloseRequested},{default:$((()=>[V("div",{ref:"rootRef",class:H([e.ns.b(),e.customClass,e.ns.is("draggable",e.draggable),{[e.ns.m("center")]:e.center}]),style:Y(e.customStyle),tabindex:"-1",onClick:n[7]||(n[7]=D((()=>{}),["stop"]))},[null!==e.title&&void 0!==e.title?(_(),K("div",{key:0,ref:"headerRef",class:H(e.ns.e("header"))},[V("div",{class:H(e.ns.e("title"))},[e.iconComponent&&e.center?(_(),O(l,{key:0,class:H([e.ns.e("status"),e.typeClass])},{default:$((()=>[(_(),O(q(e.iconComponent)))])),_:1},8,["class"])):U("v-if",!0),V("span",null,X(e.title),1)],2),e.showClose?(_(),K("button",{key:0,type:"button",class:H(e.ns.e("headerbtn")),"aria-label":e.t("el.messagebox.close"),onClick:n[0]||(n[0]=n=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel")),onKeydown:n[1]||(n[1]=F(D((n=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel")),["prevent"]),["enter"]))},[E(l,{class:H(e.ns.e("close"))},{default:$((()=>[E(r)])),_:1},8,["class"])],42,Me)):U("v-if",!0)],2)):U("v-if",!0),V("div",{id:e.contentId,class:H(e.ns.e("content"))},[V("div",{class:H(e.ns.e("container"))},[e.iconComponent&&!e.center&&e.hasMessage?(_(),O(l,{key:0,class:H([e.ns.e("status"),e.typeClass])},{default:$((()=>[(_(),O(q(e.iconComponent)))])),_:1},8,["class"])):U("v-if",!0),e.hasMessage?(_(),K("div",{key:1,class:H(e.ns.e("message"))},[x(e.$slots,"default",{},(()=>[e.dangerouslyUseHTMLString?(_(),O(q(e.showInput?"label":"p"),{key:1,for:e.showInput?e.inputId:void 0,innerHTML:e.message},null,8,["for","innerHTML"])):(_(),O(q(e.showInput?"label":"p"),{key:0,for:e.showInput?e.inputId:void 0},{default:$((()=>[N(X(e.dangerouslyUseHTMLString?"":e.message),1)])),_:1},8,["for"]))]))],2)):U("v-if",!0)],2),j(V("div",{class:H(e.ns.e("input"))},[E(i,{id:e.inputId,ref:"inputRef",modelValue:e.inputValue,"onUpdate:modelValue":n[2]||(n[2]=n=>e.inputValue=n),type:e.inputType,placeholder:e.inputPlaceholder,"aria-invalid":e.validateError,class:H({invalid:e.validateError}),onKeydown:F(e.handleInputEnter,["enter"])},null,8,["id","modelValue","type","placeholder","aria-invalid","class","onKeydown"]),V("div",{class:H(e.ns.e("errormsg")),style:Y({visibility:e.editorErrorMessage?"visible":"hidden"})},X(e.editorErrorMessage),7)],2),[[W,e.showInput]])],10,ke),V("div",{class:H(e.ns.e("btns"))},[e.showCancelButton?(_(),O(c,{key:0,loading:e.cancelButtonLoading,class:H([e.cancelButtonClass]),round:e.roundButton,size:e.btnSize,onClick:n[3]||(n[3]=n=>e.handleAction("cancel")),onKeydown:n[4]||(n[4]=F(D((n=>e.handleAction("cancel")),["prevent"]),["enter"]))},{default:$((()=>[N(X(e.cancelButtonText||e.t("el.messagebox.cancel")),1)])),_:1},8,["loading","class","round","size"])):U("v-if",!0),j(E(c,{ref:"confirmRef",type:"primary",loading:e.confirmButtonLoading,class:H([e.confirmButtonClasses]),round:e.roundButton,disabled:e.confirmButtonDisabled,size:e.btnSize,onClick:n[5]||(n[5]=n=>e.handleAction("confirm")),onKeydown:n[6]||(n[6]=F(D((n=>e.handleAction("confirm")),["prevent"]),["enter"]))},{default:$((()=>[N(X(e.confirmButtonText||e.t("el.messagebox.confirm")),1)])),_:1},8,["loading","class","round","disabled","size"]),[[W,e.showConfirmButton]])],2)],6)])),_:3},8,["trapped","focus-trap-el","focus-start-el","onReleaseRequested"])],42,we)])),_:3},8,["z-index","overlay-class","mask"]),[[W,e.visible]])])),_:3})}],["__file","/home/runner/work/element-plus/element-plus/packages/components/message-box/src/index.vue"]]);const Ie=new Map,Te=(e,n,t=null)=>{const o=E(Be,e,oe(e.message)||J(e.message)?{default:oe(e.message)?e.message:()=>e.message}:null);return o.appContext=t,Q(o,n),(e=>{let n=document.body;return e.appendTo&&(G(e.appendTo)&&(n=document.querySelector(e.appendTo)),se(e.appendTo)&&(n=e.appendTo),se(n)||(n=document.body)),n})(e).appendChild(n.firstElementChild),o.component},Se=(e,n)=>{const t=document.createElement("div");e.onVanish=()=>{Q(null,t),Ie.delete(s)},e.onAction=n=>{const t=Ie.get(s);let a;a=e.showInput?{value:s.inputValue,action:n}:n,e.callback?e.callback(a,o.proxy):"cancel"===n||"close"===n?e.distinguishCancelAndClose&&"cancel"!==n?t.reject("close"):t.reject("cancel"):t.resolve(a)};const o=Te(e,t,n),s=o.proxy;for(const a in e)ee(e,a)&&!ee(s.$props,a)&&(s[a]=e[a]);return s.visible=!0,s};function Le(e,n=null){if(!i)return Promise.reject();let t;return G(e)||J(e)?e={message:e}:t=e.callback,new Promise(((o,s)=>{const a=Se(e,null!=n?n:Le._context);Ie.set(a,{options:e,callback:t,resolve:o,reject:s})}))}const ze={alert:{closeOnPressEscape:!1,closeOnClickModal:!1},confirm:{showCancelButton:!0},prompt:{showCancelButton:!0,showInput:!0}};["alert","confirm","prompt"].forEach((e=>{Le[e]=function(e){return(n,t,o,s)=>{let a="";return ne(t)?(o=t,a=""):a=te(t)?"":t,Le(Object.assign({title:a,message:n,type:"",...ze[e]},o,{boxType:e}),s)}}(e)})),Le.close=()=>{Ie.forEach(((e,n)=>{n.doClose()})),Ie.clear()},Le._context=null;const Ae=Le;Ae.install=e=>{Ae._context=e._context,e.config.globalProperties.$msgbox=Ae,e.config.globalProperties.$messageBox=Ae,e.config.globalProperties.$alert=Ae.alert,e.config.globalProperties.$confirm=Ae.confirm,e.config.globalProperties.$prompt=Ae.prompt};const Re=Ae,Pe={id:"id",children:"children",pid:"pid"},_e=e=>Object.assign({},Pe,e),Oe=(e,n={})=>{n=_e(n);const{children:t}=n,o=[...e];for(let s=0;s<o.length;s++)o[s][t]&&o.splice(s+1,0,...o[s][t]);return o},$e=(e,n,t={})=>{t=_e(t);const o=[],s=[...e],a=new Set,{children:l}=t;for(;s.length;){const e=s[0];if(a.has(e))o.pop(),s.shift();else if(a.add(e),e[l]&&s.unshift(...e[l]),o.push(e),n(e))return o}return null},je=(e,n,t={})=>{const o=(t=_e(t)).children;return function e(t){return t.map((e=>({...e}))).filter((t=>(t[o]=t[o]&&e(t[o]),n(t)||t[o]&&t[o].length)))}(e)},Ve=(e,n)=>e.map((e=>He(e,n))),He=(e,{children:n="children",conversion:t})=>{const o=Array.isArray(e[n])&&e[n].length>0,s=t(e)||{};return o?{...s,[n]:e[n].map((e=>He(e,{children:n,conversion:t})))}:{...s}},Ye=(e,n,t={})=>{e.forEach((e=>{const o=n(e,t)||e;e.children&&Ye(e.children,n,o)}))};export{Ee as E,ge as a,Re as b,$e as c,Oe as d,Ye as e,je as f,ve as g,Ve as t,fe as u};
