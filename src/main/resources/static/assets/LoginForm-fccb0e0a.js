import{u as e,F as a}from"./useForm-2db1ec20.js";import{a0 as s,a1 as o,d as t,B as l,s as i,o as n,c as r,h as d,w as c,x as u,a as p,E as m,y as f,n as g,v as h,_ as v,K as w,b as y,m as b,u as k,a2 as R,V as _,r as j,N as x,O as P,e as I,t as E,g as z,S as F,k as C}from"./index-9270c606.js";import{E as V}from"./el-button-22a05afe.js";import{E as q}from"./tsxHelper-1ebae244.js";import{l as A,a as D,b as $}from"./index-241716f6.js";import{u as B}from"./useValidator-894bef8c.js";import{_ as L}from"./_plugin-vue_export-helper-1b428a4d.js";import"./el-popper-ba22550a.js";import"./index-09f72bc0.js";import"./el-input-b60eef14.js";import"./el-tag-9aa246f8.js";import"./el-divider-1e7c27ae.js";const S=s({type:{type:String,values:["primary","success","warning","info","danger","default"],default:"default"},underline:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},href:{type:String,default:""},icon:{type:o}}),N={click:e=>e instanceof MouseEvent},U=["href"],H=t({name:"ElLink"});const K=w(v(t({...H,props:S,emits:N,setup(e,{emit:a}){const s=e,o=l("link"),t=i((()=>[o.b(),o.m(s.type),o.is("disabled",s.disabled),o.is("underline",s.underline&&!s.disabled)]));function v(e){s.disabled||a("click",e)}return(e,a)=>(n(),r("a",{class:g(p(t)),href:e.disabled||!e.href?void 0:e.href,onClick:v},[e.icon?(n(),d(p(m),{key:0},{default:c((()=>[(n(),d(u(e.icon)))])),_:1})):f("v-if",!0),e.$slots.default?(n(),r("span",{key:1,class:g(p(o).e("inner"))},[h(e.$slots,"default")],2)):f("v-if",!0),e.$slots.icon?h(e.$slots,"icon",{key:2}):f("v-if",!0)],10,U))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/link/src/link.vue"]])),M={class:"text-2xl font-bold text-center w-[100%]"},O={class:"flex justify-between items-center w-[100%]"},G={class:"w-[100%]"},J={class:"w-[100%] mt-15px"},Q={class:"flex justify-between w-[100%]"},T=L(t({__name:"LoginForm",emits:["to-register"],setup(s,{emit:o}){const{required:t}=B(),l=y(),i=b(),{currentRoute:r,addRoute:u,push:m}=k(),{wsCache:f}=R(),{t:g}=C(),h={username:[t()],password:[t()]},v=_([{field:"title",colProps:{span:24}},{field:"username",label:g("login.username"),value:"admin",component:"Input",colProps:{span:24},componentProps:{placeholder:g("login.usernamePlaceholder")}},{field:"password",label:g("login.password"),value:"admin",component:"InputPassword",colProps:{span:24},componentProps:{style:{width:"100%"},placeholder:g("login.passwordPlaceholder")}},{field:"tool",colProps:{span:24}},{field:"login",colProps:{span:24}},{field:"other",component:"Divider",label:g("login.otherLogin"),componentProps:{contentPosition:"center"}},{field:"otherIcon",colProps:{span:24}}]),w=j(!1),{register:L,elFormRef:S,methods:N}=e(),U=j(!1),H="#999",T=j("");x((()=>r.value),(e=>{var a;T.value=null==(a=null==e?void 0:e.query)?void 0:a.redirect}),{immediate:!0});const W=async()=>{const e=p(S);await(null==e?void 0:e.validate((async e=>{if(e){U.value=!0;const{getFormData:e}=N,a=await e();try{const e=await A(a);e&&(f.set(l.getUserInfo,e.data),l.getDynamicRouter?X():(await i.generateRoutes("none").catch((()=>{})),i.getAddRouters.forEach((e=>{u(e)})),i.setIsAddRouters(!0),m({path:T.value||i.addRouters[0].path})))}finally{U.value=!1}}})))},X=async()=>{const{getFormData:e}=N,a=await e(),s={roleName:a.username},o="admin"===a.username?await D(s):await $(s);if(o){const{wsCache:e}=R(),s=o.data||[];e.set("roleRouters",s),"admin"===a.username?await i.generateRoutes("admin",s).catch((()=>{})):await i.generateRoutes("test",s).catch((()=>{})),i.getAddRouters.forEach((e=>{u(e)})),i.setIsAddRouters(!0),m({path:T.value||i.addRouters[0].path})}},Y=()=>{o("to-register")};return(e,s)=>{const o=P("Icon");return n(),d(p(a),{schema:v,rules:h,"label-position":"top","hide-required-asterisk":"",size:"large",class:"dark:border-1 dark:border-[var(--el-border-color)] dark:border-solid",onRegister:p(L)},{title:c((()=>[I("h2",M,E(p(g)("login.login")),1)])),tool:c((()=>[I("div",O,[z(p(q),{modelValue:w.value,"onUpdate:modelValue":s[0]||(s[0]=e=>w.value=e),label:p(g)("login.remember"),size:"small"},null,8,["modelValue","label"]),z(p(K),{type:"primary",underline:!1},{default:c((()=>[F(E(p(g)("login.forgetPassword")),1)])),_:1})])])),login:c((()=>[I("div",G,[z(p(V),{loading:U.value,type:"primary",class:"w-[100%]",onClick:W},{default:c((()=>[F(E(p(g)("login.login")),1)])),_:1},8,["loading"])]),I("div",J,[z(p(V),{class:"w-[100%]",onClick:Y},{default:c((()=>[F(E(p(g)("login.register")),1)])),_:1})])])),otherIcon:c((()=>[I("div",Q,[z(o,{icon:"ant-design:github-filled",size:30,class:"cursor-pointer anticon",color:H}),z(o,{icon:"ant-design:wechat-filled",size:30,class:"cursor-pointer anticon",color:H}),z(o,{icon:"ant-design:alipay-circle-filled",size:30,color:H,class:"cursor-pointer anticon"}),z(o,{icon:"ant-design:weibo-circle-filled",size:30,color:H,class:"cursor-pointer anticon"})])])),_:1},8,["schema","onRegister"])}}}),[["__scopeId","data-v-502014e3"]]);export{T as default};
